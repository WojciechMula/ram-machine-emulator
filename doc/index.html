<!doctype html public "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="pl">
<head>
	<meta http-equiv="Content-type"     content="text/html;charset=iso-8859-2">
	<meta http-equiv="Content-language" content="pl">

	<meta name="Description" content="emulator maszyny RAM">
	<meta name="Keywords"    content="maszyna RAM, emulator">
	<meta name="Author"      content="Wojciech Mu³a">
	<meta name="Generator"   content="med, nedit, vim">
	<link rel="stylesheet" href="style.css" type="text/css">
	<title>Emulator maszyny RAM - opis maszyny oraz sk³adnia programów</title>
</head>
<body>

<a href="../index.html">strona g³ówna</a>
<hr>

<h1>Spis tre¶ci</h1>

<ul>
	<li><a href="#a1">Opis maszyny RAM</a></li>
	<li><a href="#a2">Zestaw instrukcji</a></li>
	<li><a href="#a3">Sk³adnia programu</a></li>
</ul>

<a name="a1"></a>
<h1>Opis maszyny RAM</h1>

<div class="para">

<p>Jednym z modeli obliczeniowych jest <strong>maszyna RAM</strong> - maszyna o swobodnym dostêpie do pamiêci; jej schemat funkcjonalny zosta³ przedstawiony poni¿ej.

<div align="center" style="margin-top: 1em; margin-bottom: 1em">
	<img src="scheme.png" alt="schemat" class="main"><br>
	<a href="scheme.txt" title="Schemat dla przegl±darek tekstowych">Schemat dla przegl±darek tekstowych</a>
</div>

<dl>
	<dt><strong class="name">Pamiêæ programu</strong></dt>
	<dd>Przechowuje instrukcje interpretowane i wykonywane przez maszynê. Nie mo¿na jej odczytywaæ ani zapisywaæ.</dd>

	<dt><strong class="name">Licznik rozkazów</strong></dt>
	<dd>Wskazuje instrukcjê, która ma zostaæ wykonana w nastêpnym cyklu maszynowym.</dd>

	<dt><strong class="name">Pamiêæ (zespó³ rejestrów)</strong></dt>
	<dd>Sk³ada siê z nieskoñczonej liczby rejestrów, mog±cych przechowywaæ dowolnie du¿e <em>liczby	ca³kowite</em>.<br>
	    Rejestr o numerze zero nazywa siê <strong>sumatorem</strong> lub <strong>akumulatorem</strong> i jest domy¶lnym argumentem dla wiêkszo¶ci instrukcji.</dd>

	<dt><strong class="name">Ta¶ma wej¶ciowa</strong></dt>
	<dd>Z ta¶my wej¶ciowej mo¿na wy³±cznie <em>odczytywaæ dane</em>. Ma ona nieskoñczon± d³ugo¶æ, dostêp do niej jest sekwencyjny: odczytywane s± kolejne elementy, nie ma mo¿liwo¶ci jej przewijania.</dd>

	<dt><strong class="name">Ta¶ma wyj¶ciowa</strong></dt>
	<dd>Na ta¶mê wyj¶ciow± mo¿na wy³±cznie <em>zapisywaæ dane</em>. Ma ona nieskoñczon± d³ugo¶æ, dostêp do niej jest sekwencyjny: zapisywane s± kolejne elementy, nie ma mo¿liwo¶ci jej przewijania.</dd>
</dl>

<p>Poniewa¿ komputer, na którym dzia³a emulator, ma ograniczenia fizyczne, wiêc i model maszyny RAM musia³ siê im poddaæ. Pojemno¶æ rejestrów jest limitowana przez implementacjê JavaScript, <strike>ich liczba zosta³a ustalona na 1024, co wydaje siê rozs±dn± liczb±</strike> liczba rejestrów jest ograniczona tylko przez zasoby systemowe. Pojemno¶æ ta¶m jest ograniczona przez zasoby systemowe. <a href="python.html">Wersja konsolowa</a> jest pozbawiona tych ograniczeñ.
</div>

<a name="a2"></a>
<h1>Zestaw instrukcji</h1>

<div class="para">

<p>Maszyna RAM interpretuje 12 instrukcji, dla wiêkszo¶ci z nich sumator jest domy¶lnym argumentem.

<div align="center" style="margin-top: 1em; margin-bottom: 1em">
<table cellspacing="0">

<colgroup>
<col style="vertical-align: top; font-weight: bold">
<col style="text-align: right; color: blue">
<col style="font-style: italic">
</colgroup>

<tbody>

	<tr>
		<td class="rb" rowspan="3">1
		<td class="n">load
		<td class="r">=i
		<td class="n">r<sub>0</sub>
		<td class="r">:= i
	<tr>
		<td class="n">load
		<td class="r">p
		<td class="n">r<sub>0</sub>
		<td class="r">:= r<sub>P</sub>
	<tr>
		<td class="b">load
		<td class="rb">*p
		<td class="b">r<sub>0</sub>
		<td class="rb">:= r[r<sub>P</sub>]

	<tr>
		<td class="rb" rowspan="2">2
		<td class="n">store
		<td class="r">p
		<td class="n">r<sub>P</sub>
		<td class="r">:= r<sub>0</sub>
	<tr>
		<td class="b">store
		<td class="rb">*p
		<td class="b">r[r<sub>P</sub>]
		<td class="rb">:= r<sub>0</sub>

	<tr>
		<td class="rb" rowspan="3">3
		<td class="n">add
		<td class="r">=i
		<td class="n">r<sub>0</sub>
		<td class="r">:= r<sub>0</sub> + i
	<tr>
		<td class="n">add
		<td class="r">p
		<td class="n">r<sub>0</sub>
		<td class="r">:= r<sub>0</sub> + r<sub>P</sub>
	<tr>
		<td class="b">add
		<td class="rb">*p
		<td class="b">r<sub>0</sub>
		<td class="rb">:= r<sub>0</sub> + r[r<sub>P</sub>]

	<tr>
		<td class="rb" rowspan="3">4
		<td class="n">sub
		<td class="r">=i
		<td class="n">r<sub>0</sub>
		<td class="r">:= r<sub>0</sub> - i
	<tr>
		<td class="n">sub
		<td class="r">p
		<td class="n">r<sub>0</sub>
		<td class="r">:= r<sub>0</sub> - r<sub>P</sub>
	<tr>
		<td class="b">sub
		<td class="rb">*p
		<td class="b">r<sub>0</sub>
		<td class="rb">:= r<sub>0</sub> - r[r<sub>P</sub>]

	<tr>
		<td class="rb" rowspan="3">5
		<td class="n">mult
		<td class="r">=i
		<td class="n">r<sub>0</sub>
		<td class="r">:= r<sub>0</sub> * i
	<tr>
		<td class="n">mult
		<td class="r">p
		<td class="n">r<sub>0</sub>
		<td class="r">:= r<sub>0</sub> * r<sub>P</sub>
	<tr>
		<td class="b">mult
		<td class="rb">*p
		<td class="b">r<sub>0</sub>
		<td class="rb">:= r<sub>0</sub> * r[r<sub>P</sub>]

	<tr>
		<td class="rb" rowspan="3">6
		<td class="n">div
		<td class="r">=i
		<td class="n">r<sub>0</sub>
		<td class="r">:= <i>floor</i>(r<sub>0</sub> / i)
	<tr>
		<td class="n">div
		<td class="r">p
		<td class="n">r<sub>0</sub>
		<td class="r">:= <i>floor</i>(r<sub>0</sub> / r<sub>P</sub>)
	<tr>
		<td class="b">div
		<td class="rb">*p
		<td class="b">r<sub>0</sub>
		<td class="rb">:= <i>floor</i>(r<sub>0</sub> / r[r<sub>P</sub>])

	<tr>
		<td class="rb" rowspan="2">7
		<td class="n">read
		<td class="r">p
		<td class="n">r<sub>P</sub>
		<td class="r">:= warto¶æ z ta¶my wej¶ciowej
	<tr>
		<td class="b">read
		<td class="rb">*p
		<td class="b">r[r<sub>P</sub>]
		<td class="rb">:= warto¶æ z ta¶my wej¶ciowej

	<tr>
		<td class="rb" rowspan="3">8
		<td class="n">write
		<td class="r">=i
		<td class="r" colspan="2">zapisz na ta¶mê wyj¶ciow± i
	<tr>
		<td class="n">write
		<td class="r">p
		<td class="r" colspan="2">zapisz na ta¶mê wyj¶ciow± r<sub>P</sub>
	<tr>
		<td class="b">write
		<td class="rb">*p
		<td class="rb" colspan="2">zapisz na ta¶mê wyj¶ciow± r[r<sub>P</sub>]

	<tr>
		<td class="rb" rowspan="1">9
		<td class="b">jump
		<td class="rb">etykieta
		<td class="rb" colspan="2">skocz do etykiety
	<tr>
		<td class="rb" rowspan="1">10
		<td class="b">jzero
		<td class="rb">etykieta
		<td class="rb" colspan="2">skocz do etykiety gdy r<sub>0</sub> = 0
	<tr>
		<td class="rb" rowspan="1">11
		<td class="b">jgtz
		<td class="rb">etykieta
		<td class="rb" colspan="2">skocz do etykiety gdy r<sub>0</sub> &gt; 0

	<tr>
		<td class="rb" rowspan="1">12
		<td class="b">halt
		<td class="rb">&nbsp;
		<td class="rb" colspan="2">zatrzymaj program
</tbody>
</table>
<a href="table.txt" title="Tabelka dla przegl±darek tekstowych">Tabelka dla dla przegl±darek tekstowych</a>
</div>
</div>

<a name="a3"></a>
<h1>Sk³adnia programu</h1>

<div class="para">

<p>Uwagi wstêpne:
<ul>
	<li>wielko¶æ liter nie ma znaczenia, wiêc <code>LOAD 1</code> to to samo, co <code>load 1</code>, <code>Load 1</code> itd.;
	<li>puste linie s± ignorowane;
	<li>komentarz zaczyna siê znakiem # (ang. hash) i rozci±ga do koñca linii.
</ul>

<p>Pojedyncza linia programu sk³ada siê z nastêpuj±cych elementów:

<pre class="code">
numer_linii etykieta: instrukcja operand # komentarz
</pre>

<dl>

<dt><strong class="i">Numer linii</strong> (element opcjonalny, regexp: <kbd>[0-9]+</kbd>)</dt> 
<dd>
Liczba ca³kowita, dodatnia bez znaku. Pe³ni rolê informacyjn± dla pisz±cego program, jej warto¶æ jest ignorowana przez kompilator.<br>
Liniê, w której wystêpuje wy³±cznie numer linii, uznaje siê za pust±.</dd>

<dt><strong class="i">Etykieta</strong> (element opcjonalny, regexp: <kbd>[a-zA-Z_][a-zA-Z0-9_]*:</kbd>)</dt>
<dd>
Jest nazw± definiuj±c± punkt w programie, do którego mo¿e zostaæ przekazane sterowanie przez instrukcjê skoku (<code>jump</code>, <code>jzero</code>, <code>jgtz</code>). <strong>Nazwy etykiet nie mog± siê powtarzaæ.</strong><br>
W poni¿szym przyk³adzie zostan± wykonane wy³±cznie dwie instrukcje oznaczone znakiem <b>X</b>.

<pre class="code">
	jump etykieta2 # X

	# pomijany kod

etykieta1:

	# pomijany kod

etykieta2:
	halt           # X
</pre>
</dd>

<dt><strong class="i">Instrukcja</strong> (element wymagany!)</dt>
<dd>
Jest jedn± z nazw instrukcji z powy¿szej tabelki, autor wprowadzi³ jednak pewien wyj±tek odno¶nie obowi±zkowego wystêpowanie tego elementu. <br>
Teoretycznie poni¿sza konstrukcja jest b³êdna:

<pre class="code">
1 etykieta: # brak instrukcji
2	load 1
3	...
</pre>

ale kompilator j± dopuszcza. Automatycznie wstawia instrukcjê NOP (ang. <b>N</b>o <b>OP</b>eration), czyli nie-rób-nic - precyzyjniej rzecz ujmuj±c, instrukcja NOP zwiêksza wska¼nik instrukcji, ale nie wp³ywa na stan pamiêci ani ta¶m wej¶ciowej i wyj¶ciowej. Dziêki temu zabiegowi kilka etykiet mo¿e wskazywaæ na ten sam fragment kodu.<br>
<br>
Emulator ma w³asn±, wbudowan± instrukcjê NOP, jednak w kodzie maszyny RAM wystêpuj± konstrukcje o takich cechach; oto ich lista:

<pre class="code">
	load  0
	store 0
	div   =1
	mult  =1
	add   =0
	sub   =0
</pre>
</dd>

<dt><strong class="i">Operand</strong> (wymagany przez wszystkie rozkazy, za wyj±tkiem <code>halt</code>)</dt>
<dd>
W przypadku rozkazów skoku operand - adres docelowy - jest nazw± etykiety <strong>bez koñcz±cego dwukropka</strong> (regexp: <kbd>[a-zA-Z_][a-zA-Z0-9_]*</kbd>).<br>
<br>
Dla pozosta³ych rozkazów zdefiniowano trzy tryby adresowania:

<dl>
	<dt><strong class="name">Natychmiastowe (<i>=i</i>)</strong></dt>
	<dd>Warto¶æ argumentu <i>i</i> (liczba ca³kowita ze znakiem; regexp <kbd>[+-]?[0-9]+</kbd>) jest zapisana bezpo¶rednio w kodzie rozkazu.</dd>

	<dt><strong class="name">Bezpo¶rednie (<i>p</i>)</strong></dt>
	<dd>Warto¶æ argumentu <i>p</i> (liczba ca³kowita, dodatnia, bez znaku; regexp <kbd>[0-9]+</kbd>) jest numerem rejestru, którego zawarto¶æ ma zostaæ pobrana/zapisana.</dd>

	<dt><strong class="name">Po¶rednie (<i>*p</i>)</strong></dt>
	<dd>Warto¶æ argumentu <i>p</i> (liczba ca³kowita, dodatnia, bez znaku; regexp <kbd>[0-9]+</kbd>) jest numerem rejestru, którego zawarto¶æ jest traktowana jako numer rejestru, którego zawarto¶æ ma zostaæ pobrana/zapisana.</dd>
</dl>

Poni¿ej przyk³ady adresowania:

<pre class="code">
# r0 = 0, r1 = 333, r2 = 222, r3 = 2

	load =777  # r0 = 777                 natychmiastowe
	load  1    # r0 = r1 = 333            bezpo¶rednie
	load *3    # r0 = r[r3] = r[2] = 222  po¶rednie
</pre>
</dd>
</dl>
</div>

<hr>

</body>
</html>

